/*
 * Contains declarations of initialization lists common to all visitors, needing
 * some computation to be init, that are immutable and therefore can be done
 * only once.
 *
 * <hr>
 * 
 * @Package: ymirc        
 * @Module: ymirc::syntax::visitor::special
 * @File: ymirc/syntax/visitor/special.yr
 * @Author(s):
 *   - Emile Cadorel <ecadorel@gmail.com>
 *
 * @Created (YYYY-MM-DD): 2026-02-06
 * @Copyright (C) 2021â€“2026 GNU-Ymir
 * @License
 *   ```text
 *   This file is part of the Ymir language project.
 *
 *   Ymir is free software: you can redistribute it and/or modify it
 *   under the terms of the GNU General Public License as published by
 *   the Free Software Foundation, either version 3 of the License, or
 *   (at your option) any later version.
 *
 *   Ymir is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with Ymir.  If not, see <https://www.gnu.org/licenses/>.
 *   ```
 */


in special;

use ymirc::lexing::keys;
use ymirc::lexing::{tokens, keys};

/*!
 * ====================================================================================================
 * ====================================================================================================
 * ==================================          LAZY VALUES          ===================================
 * ====================================================================================================
 * ====================================================================================================
 */

/**
 * List of special operators
 * */
pub lazy __SPECIAL_TOKENS__ = SpecialKeysAndTokens ();

/**
 *  Lazy initialization of global declaration keys
 * */
pub lazy __SPECIAL_GLOBAL__ = SpecialGlobal ();

/**
 *  Lazy initialization of class declaration keys
 * */
pub lazy __SPECIAL_CLASS__ = SpecialClass ();


/*!
 * ====================================================================================================
 * ====================================================================================================
 * ====================================          RECORDS          =====================================
 * ====================================================================================================
 * ====================================================================================================
 */

/**
 * Collection containing all the special keys and token lists
 * 
 */
pub record SpecialKeysAndTokens {

    // The list of binary operators
    pub let binaryOperators        : [BinaryOperatorsLevels] = copy BinaryOperatorsLevels::__members__;

    // List of unary operators
    pub let unaryOperators         : [UnaryOperators]        = copy UnaryOperators::__members__;

    // Type decorators (MUT, DMUT)
    pub let decorators             : [Decorators]            = copy Decorators::__members__;

    // The list of tokens in a macro expression ('*', '?', '+')
    pub let macroMult              : [MacroMultTokens]       = copy MacroMultTokens::__members__;
    
    pub self () {}
}


/**
 * Global keys, to list what keys are allowed within global reading, in
 * different context
 * 
 * */
pub record SpecialGlobal {

    // Only declarations
    pub let listKeys:                [[c8]] = copy GlobalDeclKeys:: __members__;    

    // Declarations and extern
    pub let listKeysExtern:          [[c8]];    

    // Declarations + extern + use
    pub let listKeysExternUse:       [[c8]];
    
    // Declarations + extern + use + pub/prv
    pub let listKeysExternPubPrvUse: [[c8]];    

    
    pub self ()
        with listKeysExtern       = self.listKeys ~ [Keys::EXTERN]
        , listKeysExternUse       = self.listKeysExtern ~ [Keys::USE]
        , listKeysExternPubPrvUse = self.listKeysExternUse ~ [Keys::PUBLIC, Keys::PRIVATE]
    {}
}


/**
 * List of keys used inside a class or struct
 * */
pub record SpecialClass {

    // The list of keyword in a struct top level block
    pub let recordUnionDeclTop : [[c8]] = copy [Keys::PRIVATE, Keys::PUBLIC, Keys::CTE,
                                       Keys::USE, Keys::IMPL, Keys::LET,
                                       Keys::SELF, Keys::FUNCTION];

    pub let entityDeclTop : [[c8]] = copy [Keys::PRIVATE, Keys::PUBLIC, Keys::CTE,
                                           Keys::USE, Keys::IMPL, Keys::LET,
                                           Keys::SELF, Keys::FUNCTION, Keys::DTOR];

    // The list of keyword in a protected struct block
    pub let structDeclProtected : [[c8]] = copy [Keys::LET, Keys::SELF, Keys::FUNCTION];

    // The list of keyword in a class top level block
    pub let classDeclTop : [[c8]] = copy [Keys::PRIVATE, Keys::PUBLIC, Keys::PROTECTED,
                                          Keys::CTE, Keys::USE, Keys::IMPL, Keys::LET,
                                          Keys::SELF, Keys::FUNCTION, Keys::DTOR, Keys::OVER];

    // The list of keyword in a protected class block
    pub let classDeclProtected : [[c8]] = copy [Keys::LET, Keys::SELF, Keys::FUNCTION, Keys::OVER];


    pub self () {}
    
}
