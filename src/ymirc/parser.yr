mod ymirc::parser;
import ymirc::args::_;

import std::fs::path;
import std::io;
import ymirc::syntax::_;
import ymirc::errors::_;
import ymirc::utils::_;


/**
 * The main class of the ymirc compiler
 * This class perform the different parsing step of the compilation, and gives the result to the backend
 */
pub class Parser {

    /// The configuration of the parser
    let _args : YmirArguments;

    /**
     * @params: 
     *  - args: the arguments passed to the compiler
     */
    pub self (args : YmirArguments)
        with _args = args
    {
        for i in args.files {
            self:.parseFile (Path::new (i));
        }
    }


    /***
     * ============================================================================
     * ============================================================================
     * =========================          PARSING        ==========================
     * ============================================================================
     * ============================================================================
     */
    
    /**
     * Parse a given file
     * @params: 
     *  - file: the path of the file
     */
    prv def parseFile (mut self, file : &Path) {
        { 
            let module = SyntaxVisitor::new (file):.read ();
            println (module);
        } catch {
            err : &ErrorMsg => println (format ("%", err));
            x : _ => println (x);
        }
    }


    /***
     * ============================================================================
     * ============================================================================
     * =========================          GETTERS        ==========================
     * ============================================================================
     * ============================================================================
     */

    
    
    
}
