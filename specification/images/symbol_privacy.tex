\begin{figure}[H]
  \centering
  \scalebox{1.3}{
    \begin{tikzpicture}

      \filldraw (4, 1) node[align=center, above] {\texttt{\tiny{baz}}};
      \draw[-] (3.9,1) -- (3,-0.2);
      \draw[-] (4.1,1) -- (5,-0.2);

      \filldraw (3, -0.6) node[align=center, above] {\texttt{\tiny{prvFuncInBaz}}};
      \filldraw (5, -0.6) node[align=center, above] {\texttt{\tiny{pubFuncInBaz}}};


      \filldraw (0, 1) node[align=center, above] {\texttt{\tiny{foo}}};
      \draw[-] (-0.1,1) -- (-1,-0.2);
      \draw[-] (0.1,1) -- (1,-0.2);

      \filldraw (1, -0.6) node[align=center, above] {\texttt{\tiny{qux}}};
      \draw[-] (0.9,-0.6) -- (0.8,-1.8);
      \draw[-] (1.1,-0.6) -- (2.1,-1.8);

      \filldraw (0.8, -2.2) node[align=center, above] {\texttt{\tiny{prvFuncInQux}}};
      \filldraw (2.4, -2.2) node[align=center, above] {\texttt{\tiny{pubFuncInQux}}};

      \filldraw (-1, -0.6) node[align=center, above] {\texttt{\tiny{bar}}};
      \draw[-] (-1.1,-0.6) -- (-2.1,-1.8);
      \draw[-] (-0.9,-0.6) -- (-0.8,-1.8);

      \filldraw (-2.4, -2.2) node[align=center, above] {\texttt{\tiny{prvFuncInBar}}};
      \filldraw (-0.8, -2.2) node[align=center, above] {\texttt{\tiny{pubFuncInBar}}};

      \draw[rounded corners, line width=0.1pt] (-3.2, -2.3) rectangle (0, -1.6);
      \filldraw (-3.2, -1.6) node[align=center, above] {\tiny {level 1}};

      \draw[rounded corners, line width=0.1pt] (-1.3, -0.7) rectangle (1.3, -0.1);
      \filldraw (-1.3, -0.1) node[align=center, above] {\tiny {level 2}};

      \draw[rounded corners, line width=0.1pt] (-0.5, 0.8) rectangle (4.5, 1.5);
      \filldraw (-0.5, 1.5) node[align=center, above] {\tiny {level 3}};

      \draw[-Stealth,shorten >=1pt] (-3.2, -1.2) to [out=90,in=180] (-1.65, 0.1);
      \draw[-Stealth,shorten >=1pt] (-1.4, 0.3) to [out=90,in=180] (-0.9, 1.7);

      \draw[-Stealth,shorten >=1pt] (1.25, -0.35) to [out=0,in=90] (2.4, -1.8);
      \draw[-Stealth,shorten >=1pt] (4.3, 1.2) to [out=0,in=90] (5.2, -0.2);

      \draw [color=black!30!green] plot [color=red, smooth, tension=0.1] coordinates {
        (-3.15,-2.3) (-0.05,-2.3) (-0, -2.25) (-0, -1.6) (0.05, -1.55) (0.1, -1.5) (1.55, -1.5) (1.6, -1.55) (1.6, -2.25) (1.65, -2.3) (3.1, -2.3) (3.15, -2.25) (3.15, -1.6)
        (3.15, -1.4) (3.1, -1.35) (2, -1.35) (2, 0.55) (2.05, 0.6)
        (4.1, 0.6) (4.15, 0.55) (4.15, -0.6) (5.8 , -0.6) (5.8, 0.2) (5, 0.2) (4.2, 1.5) (-0.2, 1.5)  (-0.5, 0.4) (-0.6, 0) (-1.2, -0.1) (-1.4, -0.4)  (-2, -1.55) (-2.05, -1.59) (-3, -1.59) (-3.1, -1.59)
        (-3.15, -1.6) (-3.2, -1.65) (-3.2, -2.2) (-3.2, -2.25) (-3.15, -2.3)
      };


    \end{tikzpicture}
  }
  \caption{\label{fig:symbol_privacy} Example of symbol lookup protections from \texttt{foo::bar::pubFuncInBar}}
\end{figure}
