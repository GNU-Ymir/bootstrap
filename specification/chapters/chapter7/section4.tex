\section{Conditional loop}%
\label{sec:while_loop}

Conditional loops continue iterating as long as a specified condition remains
true. They are initialized with the keyword \token{while} and follow the syntax
\token{while C V}, where \token{C} represents the condition that must be
satisfied, and \token{V} is the value evaluated while the condition remains
true. Similar to conditional branching, the condition \token{C} must be of type
\token{bool}. The following example showcases a while loop that iterates five
times before exiting. Its control flow is illustrated in
Figure~\ref{fig:(chap7):simple_while_loop}

\begin{lstlisting}[style=coloredverbatim, caption=Simple while loop, label=lst:(chap7):simple_while_loop]
let mut count = 0;

while count < 5 {
  count += 1;
}

assert (count == 5);
\end{lstlisting}

\input{chapters/chapter7/figures/simple_while_loop}

\subsection{Do-while loop}
\label{sec:do_while_loop}

While loops are activated if the associated condition is true from the outset.
In contrast, do-while loops, first execute the loop body before evaluating the
loop condition. This guarantees that the loop body runs at least once,
irrespective of whether the condition is initially false. Do-while loops are
defined with the syntax \token{do V while C;}, where \token{V} represents the
value evaluated upon entering the loop, and \token{C} is the condition that
halts the loop when it evaluates to \token{false}.

\begin{lstlisting}[style=coloredverbatim, caption=Simple do while loop, label=lst:simple_do_while_loop]
let mut count = 0;

do {
  count += 1;
} while count < 5;

assert (count == 5);
\end{lstlisting}

\input{chapters/chapter7/figures/simple_do_while_loop}

\subsection{While-let loop}
\label{sec:while_let_loop}

In conditional branching, as discussed in Section~\ref{sec:cond_pattern}, a
pattern can serve as the condition. This capability, similar to its usage in if
conditionals, is available for while loops. However, it is not applicable for
do-while loops. In the following given example, the loop continues as long as
the option contained within the variable \token{x} holds a value and halts
either when it doesn't hold a value or when its value exceeds \token{5}. The
code presented in Listing~\ref{lst:(chap7):while_let_rewritten} exhibits identical
behavior, albeit implemented using a loop construct and an if let conditional,
as the compiler rewrites the code from Listing~\ref{lst:(chap7):while_let_example}.

\begin{lstlisting}[style=coloredverbatim, caption=While-let example, label=lst:(chap7):while_let_example]
fn foo (i : i32)-> i32?;

let mut x = foo (0);
let mut count = 0;

while let Ok (z) = x && z < 5 {
  count += 1;
  x = foo (count);
}
\end{lstlisting}

\begin{lstlisting}[style=coloredverbatim, caption=While-let rewritten using loop and if-let, label=lst:while_let_rewritten]
fn foo (i : i32)-> i32?;

let mut x = foo (0);
let mut count = 0;

loop {
  if let Ok (z) = x && z < 5 {
    count += 1;
    x = foo (count);
  } else break;
}
\end{lstlisting}

As one might expect, since while-let is merely a syntactic transformation into a
loop over an if pattern condition, all the pattern and guard systems discussed
in Section~\ref{sec:cond_pattern} are applicable to the while-let construction.

\subsection{While loop value}

While loops don't inherently produce any values, as there's no assurance that
the loop will be entered and a value constructed. Conversely, do-while loops are
guaranteed to be entered at least once, potentially allowing for a value to be
constructed. However, to maintain consistency with basic while loops, it was
decided not to allow value construction from do-while loops. In essence, only
infinite loops defined with the \token{loop} keyword have the capability to
construct a value. As a consequence, a \textit{break} statement within a
\textit{while} or \textit{do-while} loop cannot be linked with a value and must
always yield a \token{void} result.


\vfill%
\pagebreak
